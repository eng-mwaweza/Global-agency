{% extends 'global_agency/base.html' %}
{% block title %}Home{% endblock %}
{% block content %}
{% include 'global_agency/includes/hero.html' %}

<!-- Floating Action Buttons Container -->
<div id="floatingButtons" class="fixed bottom-4 z-50 w-full px-4 pointer-events-none">
    <div class="flex justify-between items-center max-w-7xl mx-auto">
        <!-- Student Portal Button - Left Side -->
        <a href="{% url 'student_portal:login' %}" 
           id="studentPortalBtn"
           class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-4 md:py-3 md:px-6 rounded-full shadow-lg pointer-events-auto transition-all duration-300 transform flex items-center gap-2 text-sm md:text-base">
           <svg class="w-4 h-4 md:w-5 md:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
           </svg>
           <span class="hidden xs:inline">Student Portal</span>
           <span class="xs:hidden">Portal</span>
        </a>

        <!-- Start Application Button - Right Side -->
        <a href="{% url 'global_agency:start_application' %}" 
           id="startApplicationBtn"
           class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-3 px-4 md:py-3 md:px-6 rounded-full shadow-lg pointer-events-auto transition-all duration-300 transform flex items-center gap-2 text-sm md:text-base">
           <svg class="w-4 h-4 md:w-5 md:h-5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
           </svg>
           <span class="hidden xs:inline">Start Application</span>
           <span class="xs:hidden">Apply</span>
        </a>
    </div>
</div>

<!-- Alternative: Stacked Layout for Very Small Screens (Optional) -->
<div id="floatingButtonsStacked" class="fixed bottom-4 right-4 z-50 hidden pointer-events-none">
    <div class="flex flex-col gap-2 items-end">
        <!-- Student Portal Button -->
        <a href="{% url 'student_portal:login' %}" 
           class="bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-3 rounded-full shadow-lg pointer-events-auto transition-all duration-300 transform flex items-center gap-1 text-xs">
           <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
           </svg>
           Portal
        </a>

        <!-- Start Application Button -->
        <a href="{% url 'global_agency:start_application' %}" 
           class="bg-yellow-500 hover:bg-yellow-600 text-white font-bold py-2 px-3 rounded-full shadow-lg pointer-events-auto transition-all duration-300 transform flex items-center gap-1 text-xs">
           <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
               <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
           </svg>
           Apply
        </a>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const studentBtn = document.getElementById('studentPortalBtn');
    const applicationBtn = document.getElementById('startApplicationBtn');
    const floatingButtons = document.getElementById('floatingButtons');
    const stackedButtons = document.getElementById('floatingButtonsStacked');
    
    let lastScrollTop = 0;
    let buttonsVisible = true;

    // Responsive button layout
    function handleResponsiveLayout() {
        const width = window.innerWidth;
        
        if (width < 480) {
            // Very small screens - use stacked layout
            floatingButtons.classList.add('hidden');
            stackedButtons.classList.remove('hidden');
        } else {
            // Normal screens - use side-by-side layout
            floatingButtons.classList.remove('hidden');
            stackedButtons.classList.add('hidden');
        }
    }

    // Scroll behavior
    function handleScroll() {
        const st = window.pageYOffset || document.documentElement.scrollTop;

        if (st > lastScrollTop && st > 100) {
            // Scrolling down → hide buttons
            if (buttonsVisible) {
                floatingButtons.style.transform = 'translateY(100px)';
                stackedButtons.style.transform = 'translateY(100px)';
                buttonsVisible = false;
            }
        } else if (st < lastScrollTop) {
            // Scrolling up → show buttons
            if (!buttonsVisible) {
                floatingButtons.style.transform = 'translateY(0)';
                stackedButtons.style.transform = 'translateY(0)';
                buttonsVisible = true;
            }
        }
        lastScrollTop = st <= 0 ? 0 : st;
    }

    // Hover effects for side-by-side buttons
    function setupHoverEffects() {
        [studentBtn, applicationBtn].forEach(btn => {
            if (btn) {
                btn.addEventListener('mouseenter', function() {
                    if (buttonsVisible) this.style.transform = 'scale(1.05)';
                });
                btn.addEventListener('mouseleave', function() {
                    if (buttonsVisible) this.style.transform = 'scale(1)';
                });
            }
        });

        // Hover effects for stacked buttons
        const stackedBtns = stackedButtons.querySelectorAll('a');
        stackedBtns.forEach(btn => {
            btn.addEventListener('mouseenter', function() {
                if (buttonsVisible) this.style.transform = 'scale(1.05)';
            });
            btn.addEventListener('mouseleave', function() {
                if (buttonsVisible) this.style.transform = 'scale(1)';
            });
        });
    }

    // Touch device optimizations
    function setupTouchOptimizations() {
        // Increase tap target size on touch devices
        if ('ontouchstart' in window) {
            const buttons = document.querySelectorAll('#floatingButtons a, #floatingButtonsStacked a');
            buttons.forEach(btn => {
                btn.classList.add('min-h-[44px]', 'min-w-[44px]');
            });
        }
    }

    // Initialize everything
    handleResponsiveLayout();
    setupHoverEffects();
    setupTouchOptimizations();
    
    // Event listeners
    window.addEventListener('scroll', handleScroll);
    window.addEventListener('resize', handleResponsiveLayout);

    // Add smooth appearance animation
    setTimeout(() => {
        floatingButtons.style.opacity = '1';
        stackedButtons.style.opacity = '1';
    }, 100);
});

// Add CSS for custom breakpoints
const style = document.createElement('style');
style.textContent = `
    #floatingButtons, #floatingButtonsStacked {
        opacity: 0;
        transition: opacity 0.3s ease;
    }
    
    /* Custom breakpoint for extra small screens */
    @media (max-width: 480px) {
        #floatingButtons {
            display: none !important;
        }
    }
    
    @media (min-width: 481px) {
        #floatingButtonsStacked {
            display: none !important;
        }
    }
    
    /* Ensure buttons don't interfere with content on very small screens */
    @media (max-width: 320px) {
        #floatingButtonsStacked {
            bottom: 2rem;
            right: 1rem;
        }
    }
    
    /* Large screen optimizations */
    @media (min-width: 1024px) {
        #floatingButtons {
            bottom: 2rem;
        }
    }
    
    /* Prevent buttons from overlapping with mobile browser UI */
    @media (max-height: 500px) {
        #floatingButtons, #floatingButtonsStacked {
            bottom: 1rem;
        }
    }
    
    /* High contrast mode support */
    @media (prefers-contrast: high) {
        #studentPortalBtn, #startApplicationBtn {
            border: 2px solid white;
        }
    }
    
    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
        #studentPortalBtn, #startApplicationBtn,
        #floatingButtons, #floatingButtonsStacked {
            transition: none;
        }
    }
`;
document.head.appendChild(style);
</script>

{% include 'global_agency/includes/about.html' %}
{% include 'global_agency/includes/services.html' %}
{% include 'global_agency/includes/success.html' %}
{% include 'global_agency/includes/destinations.html' %}
{% include 'global_agency/includes/contact.html' %}

{% load static %}
{% endblock %}